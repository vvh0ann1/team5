# Linux Server: /etc/hosts 파일 소유자 및 권한 설정
---
- name: Check /etc/hosts file ownership and permissions
  hosts: aws_web
  become: yes
  vars:
    hosts_file_path: '/etc/hosts'  # 검사할 파일 경로

  tasks:
    - name: Check ownership and permissions of /etc/hosts
      stat:
        path: "{{ hosts_file_path }}"
      register: hosts_file_info

    - name: Display current permissions in octal
      debug:
        msg: "Current permissions for /etc/hosts: {{ hosts_file_info.stat.mode | int }}"

    - name: Check if /etc/hosts is secure
      debug:
        msg: "Secure: /etc/hosts is owned by root and permissions are 644 or lower."
      when: hosts_file_info.stat.pw_name == 'root' and hosts_file_info.stat.mode | int <= 644

    - name: Check if /etc/hosts is vulnerable
      debug:
        msg: "Vulnerable: /etc/hosts is either not owned by root or permissions are greater than 644."
      when: hosts_file_info.stat.pw_name != 'root' or hosts_file_info.stat.mode | int > 644
